<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Example Home</title>
    <style>
        /* 공통 스타일 */
        body {
            margin: 0;
            padding: 0;
            background-color: #2F4F4F;
            font-family: 'Arial', sans-serif;
            height: 100vh;
            display: flex;
            flex-direction: column;
            box-sizing: border-box;
            color: white;
        }

		.container {
			display: flex;
			flex-direction: column;
			height: 100%;
			width: 100%;
			padding: 20px;
			gap: 20px;
			box-sizing: border-box;
		}

        /* 상단 패널 (검색과 필터) */
        .top-panel {
            display: flex;
            gap: 20px;
            width: 100%;
        }

        .search-panel {
        flex: 0 0 300px;    /* 너비를 300px로 고정하고 늘어나지 않도록 설정 */
        display: flex;
        flex-direction: column;
        }

        .right-panel {
            flex: 1;    /* 남은 공간을 모두 차지하도록 설정 */
            display: flex;
            flex-direction: column;
        }

        .verify-panel {
            flex: 0 0 auto;    /* 내용물 크기만큼만 차지하도록 설정 */
            background-color: #3D5C5C;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px; /* verify-panel과 result-panel 사이의 간격 */
        }

        .result-panel {
            flex: 1;
            background-color: #3D5C5C;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: auto; /* 내용이 많을 경우 스크롤 생성 */
        }

        /* verify-panel 내부 요소 스타일 */
        .verify-row {
            display: flex;
            justify-content: space-between;
            gap: 20px; /* 항목 간 간격 */
        }

        .verify-item {
            flex: 1 1 0; /* flex-grow: 1, flex-shrink: 1, flex-basis: 0 */
            min-width: 0; /* 내용이 넘칠 때 줄바꿈 허용 */
        }

        .verify-panel label {
            display: block;
            margin-bottom: 8px;
            color: white;
            white-space: nowrap; /* 라벨 텍스트가 줄바꿈되지 않도록 설정 */
            overflow: hidden;
            text-overflow: ellipsis; /* 라벨이 너무 길 경우 말줄임표 표시 */
        }

        .verify-panel select {
            width: 100%;
            padding: 10px;
            background-color: #2F4F4F;
            /* border: 1px solid #ccc; */
            border: 1px solid #2A3F33;
            border-radius: 5px;
            box-sizing: border-box;
            color: white;
        }

        /* 반응형 디자인을 위한 미디어 쿼리 */
        @media (max-width: 768px) {
            .top-panel {
                flex-direction: column;
            }

            .search-panel {
                flex: none;
                width: 100%;
            }

            .verify-row {
                flex-direction: column;
            }

            .verify-item {
                margin-bottom: 15px;
            }
        }

        /* 검색 필드 스타일 */
        .input-section {
            background-color: #3D5C5C;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .input-section label {
            display: block;
            margin-bottom: 8px;
            color: white;
        }

        .input-section input, .input-section select {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            background-color: #2F4F4F;
            /* border: 1px solid #ccc; */
            border: 1px solid #2A3F33;
            border-radius: 5px;
            box-sizing: border-box;
            color: white;
        }

        input::placeholder {
            color: #A0A0A0;
        }

		.input-section input:focus,
		.input-section select:focus {
			border-color: #00bcd4;
			/* 포커스 시 좀 더 강렬한 색상으로 */
			outline: none;
		}

        .buttons button {
            width: 48%;
            padding: 10px;
            /* background-color: #2F4F4F; */
            background-color: #406b6b;
            border: none;
            /* border: 1px solid #ccc; */
            /* border: 1px solid #8d8c8c; */
            border-radius: 5px;
            color: #fff;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .buttons button:hover {
            opacity: 0.9;
            background-color: #25403C;
        }

        .buttons button:active {
            background-color: #1e3330;
        }

        .quick-range-buttons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .quick-range-buttons button {
            width: 30%;
            padding: 10px;
            /* background-color: #2F4F4F; */
            background-color: #406b6b;
            border: none;
            /* border: 1px solid #ccc; */
            /* border: 1px solid #8d8c8c; */
            border-radius: 5px;
            color: #fff;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .quick-range-buttons button:hover {
            opacity: 0.8;
            background-color: #25403C;
        }

        .quick-range-buttons button:active {
            background-color: #1e3330;
        }
        
        /* 검색 결과 테이블 */
        .result-panel {
            background-color: #3D5C5C;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: auto;
        }

        .result-table table {
            width: 100%;
            border-collapse: collapse;
            /* background-color: #3D5C5C; */
            background-color: #2F4F4F;
        }

        .result-table th, .result-table td {
            padding: 10px;
            text-align: center;
            /* border: 1px solid #ccc; */
            border: 1px solid #2A3F33;
            color: white;
        }

        /* 하단 패널 */
        .bottom-panels {
            display: flex;
            gap: 20px;
            flex: 1;
        }

        .history-panel, .report-panel {
            flex: 1;
            background-color: #3D5C5C;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: auto;
        }
        
        .history-panel h3, .report-panel h3 {
            margin-bottom: 20px;
            color: white;
        }

        .history-info-container label, .study-info-container label {
            display: block;
            margin-bottom: 5px;
            /* color: #ccc; */
            color: white;
        }

        .info-item {
            padding: 10px;
            margin-bottom: 15px;
            background-color: #2F4F4F;
            /* border: 1px solid #ccc; */
            border: 1px solid #2A3F33;
            border-radius: 5px;
            color: white;
        }

        /* .info-item label {
            display: block;
            margin-bottom: 5px;
            color: white;
        } */

        /* 달력 스타일 */
        .calendar-panel {
            margin-bottom: 20px;    /* 환자 ID 위에 위치하도록 설정 */
            background-color: #3D5C5C;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .calendar-panel table {
            width: 100%;
            border-collapse: collapse;
            border-radius: 10px;
            background-color: #2F4F4F;
        }

        .calendar-panel th, .calendar-panel td {
            padding: 10px;
            text-align: center;
            /* border: 1px solid #8d8c8c; */
            border-bottom: 1px solid #2A3F33;
            /* border: none; */
            border-radius: 100px;
            color: white;
        }

        /* calendar-title 영역 css */
        .calendar-header {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 10px;
        }

        .calendar-header button {
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            padding: 5px 10px;
        }

        #calendar-title {
            font-size: 18px;
            margin: 0 10px;
        }

        .current-day {
            background-color: #497c7c !important;
            color: #2F4F4F !important;
        }

        /* 선택된 날짜 강조 */
        .highlighted-range {
            background-color: #436464;
        }

		.selected-date {
			background-color: #ff9999;
		}

		/* 끝 날짜 강조 */
		.end-date {
			background-color: #ff6666;
        }

        .calendar-panel td {
            cursor: pointer;
        }

        /* 빈 셀에는 기본 커서 유지 */
        .calendar-panel td:empty {
            cursor: default;
        }

        /* 검사일자 관련 css */
        .date-range-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .date-range-container label {
            white-space: nowrap;
        }

        .date-range-container input[type="date"] {
            padding: 5px;
            /* border: 1px solid #ccc; */
            border: 1px solid #2A3F33;
            border-radius: 4px;
            /* color: #8d8c8c; */
        }
    </style>
</head>

<body>

	<div class="container">
		<!-- 상단 패널 (검색과 검색 결과) -->
		<div class="top-panel">
			<!-- 검색 패널 -->
			<div class="search-panel">

            <!-- 달력 영역 추가 -->
            <div class="calendar-panel">
                <div class="calendar-header">
                    <button id="prev-month">&lt;</button>
                    <span id="calendar-title"></span>
                    <button id="next-month">&gt;</button>
                </div>
                <table>
                    <thead>
                    <tr>
                        <th>일</th>
                        <th>월</th>
                        <th>화</th>
                        <th>수</th>
                        <th>목</th>
                        <th>금</th>
                        <th>토</th>
                    </tr>
                    </thead>
                    <tbody id="calendar-body"></tbody> <!-- 달력이 렌더링될 영역 -->
                </table>
            </div>

            <div class="input-section">
                <label>환자 ID</label>
                <input type="text" id="patient-id" placeholder="환자 ID를 입력하세요">

                <label>환자 이름</label>
                <input type="text" id="patient-name" placeholder="환자 이름을 입력하세요">

                <div class="date-range-container">
                    <label for="start-date">검사일자</label>
                    <input type="date" id="start-date">
                    <span>~</span>
                    <input type="date" id="end-date">
                </div>

                <div class="quick-range-buttons">
                    <button id="one-day-btn">1일</button>
                    <button id="three-day-btn">3일</button>
                    <button id="week-btn">1주일</button>
                </div>

                <br>

                <div class="buttons">
                    <button class="search-btn">조회</button>
                    <button class="reset-btn" id="reset-btn">재설정</button>
                </div>
            </div>
        </div>

        <div class="right-panel">
            <div class="verify-panel">
                <div class="verify-row">
                    <div class="verify-item">
                        <label for="equipment-select">검사장비</label>
                        <select id="equipment-select">
                            <option>선택해주세요</option>
                            <option>AS</option>
                            <option>AU</option>
                            <option>BI</option>
                            <option>CD</option>
                            <option>CF</option>
                            <option>CP</option>
                            <option>CR</option>
                            <option>CS</option>
                            <option>CT</option>
                            <option>DD</option>
                            <option>DF</option>
                            <option>DG</option>
                            <option>DM</option>
                            <option>DR</option>
                            <option>DS</option>
                            <option>DX</option>
                            <option>EC</option>
                            <option>ES</option>
                            <option>FA</option>
                            <option>FS</option>
                            <option>LS</option>
                            <option>LP</option>
                            <option>MA</option>
                            <option>MR</option>
                            <option>MS</option>
                            <option>NM</option>
                            <option>OT</option>
                            <option>PT</option>
                            <option>RF</option>
                            <option>RG</option>
                            <option>ST</option>
                            <option>TG</option>
                            <option>US</option>
                            <option>VF</option>
                            <option>XA</option>
                            <!-- 추가 옵션 -->
                        </select>
                    </div>
                    <div class="verify-item">
                        <label for="verify-select">Verify</label>
                        <select id="verify-select">
                            <option>선택해주세요</option>
                            <option>미요청</option>
                            <option>요청완료</option>
                        </select>
                    </div>
                    <div class="verify-item">
                        <div id="patient-id">환자 ID</div><br>
                        <div id="patient-name">이름</div>
                    </div>
                </div>
            </div>
    

            <!-- 검색 결과 패널 -->
            <div class="result-panel">
                <div class="result-table">
                    <table>
                        <thead>
                        <tr>
                            <th>환자 ID</th>
                            <th>환자 이름</th>
                            <th>검사 장비</th>
                            <th>검사 설명</th>
                            <th>검사 일시</th>
                            <th>판독 상태</th>
                            <th>시리즈</th>
                            <th>이미지</th>
                            <th>Verify</th>
                        </tr>
                        </thead>
                        <tbody>
                        <!-- 검색 결과 추가 -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- 하단 패널 (과거 검사 이력 및 Study 정보) -->
    <div class="bottom-panels">
        <!-- 과거 검사 이력 -->
        <div class="history-panel">
            <h3>과거 검사 이력</h3>
            <div class="history-info-container">
                <!-- <label>환자 아이디: 12345</label>
                <label>환자 이름: 홍길동</label> -->
                <div class="info-item">환자 ID: 12345</div>
                <div class="info-item">환자 이름: 홍길동</div>
                <div class="info-item">검사 장비: CT</div>
                <div class="info-item">검사 설명: 복부 CT</div>
                <div class="info-item">검사 일시: 2023-01-01</div>
                <div class="info-item">판독 상태: 완료</div>
            </div>
        </div>

        <!-- 리포트 패널 -->
        <div class="report-panel">
            <h3>리포트 (Study 정보)</h3>
            <div class="study-info-container">
                <label>검사 설명</label>
                <div class="info-item">복부 CT</div>

                <label>촬영 부위</label>
                <div class="info-item">복부</div>

                <label>환자 번호</label>
                <div class="info-item">12345</div>

                <label>환자 이름</label>
                <div class="info-item">홍길동</div>

                <label>환자 성별</label>
                <div class="info-item">남성</div>

                <label>수술한 의사</label>
                <div class="info-item">Dr. Kim</div>

                <label>AI 진단 내용</label>
                <div class="info-item">이상 없음</div>

                <label>AI 진단 병명</label>
                <div class="info-item">정상</div>

                <label>촬영 방향</label>
                <div class="info-item">AP</div>
            </div>
        </div>
	</div>
</div>

	<!-- 달력 및 기타 스크립트 -->
	<script>
		document.addEventListener("DOMContentLoaded", function () {
			const today = new Date();
			let currentYear = today.getFullYear();
			let currentMonth = today.getMonth();
			let startDate = null;
			let endDate = null;

			// 범위 강조
			function highlightRange(start, end) {
				console.log("start : ", start);
				console.log("end : ", end);
				const calendarBody = document.getElementById("calendar-body");
				const cells = calendarBody.getElementsByTagName("td");
				for (let i = 0; i < cells.length; i++) {
					const cellDate = parseInt(cells[i].textContent);
					const cellFullDate = new Date(currentYear, currentMonth, cellDate);
					if (!isNaN(cellDate) && cellFullDate >= start && cellFullDate <= end) {
						cells[i].classList.add("highlighted-range");
					} else {
						cells[i].classList.remove("highlighted-range");  // 이전 강조 제거
					}
				}
			}

			// 달력 업데이트
			function updateCalendar() {
				const monthNames = ["1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월", "12월"];
				document.getElementById("calendar-title").textContent = `${currentYear}년 ${monthNames[currentMonth]}`;

				const firstDay = new Date(currentYear, currentMonth, 1).getDay();
				const lastDate = new Date(currentYear, currentMonth + 1, 0).getDate();
				const calendarBody = document.getElementById("calendar-body");
				calendarBody.innerHTML = "";
				let date = 1;

				for (let i = 0; i < 6; i++) {
					const row = document.createElement("tr");
					for (let j = 0; j < 7; j++) {
						const cell = document.createElement("td");
						if (i === 0 && j < firstDay) {
							cell.textContent = "";
						} else if (date > lastDate) {
							break;
						} else {
							cell.textContent = date;
							cell.dataset.date = date;

							// 클릭 이벤트 추가
							cell.addEventListener('click', function () {
								selectDate(cell);
							});

							// 현재 날짜 표시
							if (currentYear === today.getFullYear() && currentMonth === today.getMonth() && date === today.getDate()) {
								cell.classList.add("current-day");
							}

							// 이전에 선택된 날짜 복원
							if (startDate && new Date(currentYear, currentMonth, date).getTime() === startDate.getTime()) {
								cell.classList.add('selected-date');
							}
							if (endDate && new Date(currentYear, currentMonth, date).getTime() === endDate.getTime()) {
								cell.classList.add('end-date');
							}

							date++;
						}
						row.appendChild(cell);
					}
					calendarBody.appendChild(row);
				}

				// 선택된 날짜 범위 강조
				if (startDate && endDate) {
					highlightRange(startDate, endDate);
				}
			}

			// 날짜 선택
			function selectDate(cell) {
				
				const selectedDate = parseInt(cell.dataset.date);

				if (!startDate) {
					startDate = new Date(currentYear, currentMonth, selectedDate);
					cell.classList.add('selected-date');
				} else if (!endDate) {
					endDate = new Date(currentYear, currentMonth, selectedDate);

					if (startDate > endDate) {
						[startDate, endDate] = [endDate, startDate];  // 시작일과 끝일이 반대면 교환
					}

					highlightRange(startDate, endDate);
					cell.classList.add('end-date'); // 끝 날짜도 빨간색으로

					// 날짜 선택 후 검사일자 입력 필드에 설정
					const formattedStartDate = `${startDate.getFullYear()}-${String(startDate.getMonth() + 1).padStart(2, '0')}-${String(startDate.getDate()).padStart(2, '0')}`;
					const formattedEndDate = `${endDate.getFullYear()}-${String(endDate.getMonth() + 1).padStart(2, '0')}-${String(endDate.getDate()).padStart(2, '0')}`;

					document.getElementById("start-date").value = formattedStartDate;
					document.getElementById("end-date").value = formattedEndDate;
				} else {
					clearSelection();
					startDate = new Date(currentYear, currentMonth, selectedDate);
					cell.classList.add('selected-date');
				}
			}

			// 선택 초기화
			function clearSelection() {
				const calendarBody = document.getElementById("calendar-body");
				const cells = calendarBody.getElementsByTagName("td");
				for (let i = 0; i < cells.length; i++) {
					cells[i].classList.remove('selected-date');
					cells[i].classList.remove('highlighted-range');
					cells[i].classList.remove('end-date');
				}
				startDate = null;
				endDate = null;
			}

			// 이전/다음 달로 이동 시 선택된 날짜 유지
			document.getElementById("prev-month").addEventListener("click", function () {
				currentMonth = currentMonth === 0 ? 11 : currentMonth - 1;
				currentYear = currentMonth === 11 ? currentYear - 1 : currentYear;
				updateCalendar(); // 달력 업데이트 시 선택된 날짜 유지
			});

			document.getElementById("next-month").addEventListener("click", function () {
				currentMonth = currentMonth === 11 ? 0 : currentMonth + 1;
				currentYear = currentMonth === 0 ? currentYear + 1 : currentYear;
				updateCalendar(); // 달력 업데이트 시 선택된 날짜 유지
			});

			updateCalendar();

			// 날짜 범위를 설정하는 함수
			function setDateRange(days) {
				clearSelection();  // 이전 선택 초기화
				const startDateObj = new Date(today);
				const startDateObj2 = new Date(today);
				startDateObj.setDate(today.getDate() - days);  // 시작일 설정
				startDateObj2.setDate(today.getDate() - days + 1);  // 시작일 설정
				startDate = startDateObj;  // 시작일 저장
				endDate = today;  // 끝일 저장

				highlightRange(startDate, endDate);  // 새로 설정된 범위 강조
				document.getElementById("start-date").value = startDateObj2.toISOString().split('T')[0];
				document.getElementById("end-date").value = today.toISOString().split('T')[0];
			}

			// 1일, 3일, 1주일 버튼 클릭 이벤트
			document.getElementById("one-day-btn").addEventListener("click", function () {
				setDateRange(2);  // 1일 범위 설정
			});

			document.getElementById("three-day-btn").addEventListener("click", function () {
				setDateRange(4);  // 3일 범위 설정
			});

			document.getElementById("week-btn").addEventListener("click", function () {
				setDateRange(8);  // 1주일 범위 설정
			});

			// 날짜 입력 필드에 이벤트 리스너 추가
			document.getElementById("start-date").addEventListener("input", function () {
				const startInputValue = this.value;
				if (startInputValue) {
					startDate = new Date(startInputValue);
					startDate.setHours(0, 0, 0, 0); // 시간 제거
					if (endDate) {
						highlightRange(startDate, endDate);
					}
				}
			});

			document.getElementById("end-date").addEventListener("input", function () {
				const endInputValue = this.value;
				if (endInputValue) {
					endDate = new Date(endInputValue);
					endDate.setHours(0, 0, 0, 0); // 시간 제거
					if (startDate) {
						highlightRange(startDate, endDate);
					}
				}
			});


			// 재설정 버튼 클릭 시 필드 초기화
			document.getElementById("reset-btn").addEventListener("click", function () {
				document.getElementById("start-date").value = "";
				document.getElementById("end-date").value = "";
				document.getElementById("equipment-select").value = "선택해주세요";
				document.getElementById("verify-select").value = "선택해주세요";
				document.getElementById("patient-id").value = "";
				document.getElementById("patient-name").value = "";
				clearSelection();
			});

            document.getElementById("week-btn").addEventListener("click", function() {
                setDateRange(7);
            });
    
            // 날짜 포맷 함수
            function formatDate(date) {
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                return `${year}-${month}-${day}`;
            }
		});
    </script>

</body>
</html>